<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Arquero API Reference | arquero</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Arquero API Reference" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Query processing and transformation of array-backed data tables." />
<meta property="og:description" content="Query processing and transformation of array-backed data tables." />
<link rel="canonical" href="https://idl.uw.edu/arquero/api/" />
<meta property="og:url" content="https://idl.uw.edu/arquero/api/" />
<meta property="og:site_name" content="arquero" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Arquero API Reference" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Query processing and transformation of array-backed data tables.","headline":"Arquero API Reference","url":"https://idl.uw.edu/arquero/api/"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="../assets/css/style.css@v=e8003b487ac362f5679ed130cb3a6597b684f903.css">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/arquero/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="https://idl.uw.edu/arquero/">arquero</a></h1>
      

      <h1 id="arquero-api-reference-">Arquero API Reference <a href="https://idl.uw.edu/arquero"><img align="right" src="../assets/logo.svg" height="38" /></a></h1>

<table>
  <tbody>
    <tr>
      <td><a href="https://idl.uw.edu/arquero/api"><strong>Top-Level</strong></a></td>
      <td><a href="https://idl.uw.edu/arquero/api/table">Table</a></td>
      <td><a href="https://idl.uw.edu/arquero/api/verbs">Verbs</a></td>
      <td><a href="https://idl.uw.edu/arquero/api/op">Op Functions</a></td>
      <td><a href="https://idl.uw.edu/arquero/api/expressions">Expressions</a></td>
      <td><a href="https://idl.uw.edu/arquero/api/extensibility">Extensibility</a></td>
    </tr>
  </tbody>
</table>

<ul>
  <li><a href="index.html#table-constructors">Table Constructors</a>
    <ul>
      <li><a href="index.html#table">table</a>, <a href="index.html#from">from</a></li>
    </ul>
  </li>
  <li><a href="index.html#input">Table Input</a>
    <ul>
      <li><a href="index.html#loadArrow">loadArrow</a>, <a href="index.html#loadCSV">loadCSV</a>, <a href="index.html#loadFixed">loadFixed</a>, <a href="index.html#loadJSON">loadJSON</a></li>
      <li><a href="index.html#fromArrow">fromArrow</a>, <a href="index.html#fromCSV">fromCSV</a>, <a href="index.html#fromFixed">fromFixed</a>, <a href="index.html#fromJSON">fromJSON</a></li>
      <li><a href="index.html#fromArrowStream">fromArrowStream</a>, <a href="index.html#fromCSVStream">fromCSVStream</a>, <a href="index.html#fromFixedStream">fromFixedStream</a>, <a href="index.html#fromJSONStream">fromJSONStream</a></li>
    </ul>
  </li>
  <li><a href="index.html#expression-helpers">Expression Helpers</a>
    <ul>
      <li><a href="index.html#op">op</a>, <a href="index.html#agg">agg</a>, <a href="index.html#escape">escape</a></li>
      <li><a href="index.html#bin">bin</a>, <a href="index.html#collate">collate</a>, <a href="index.html#desc">desc</a>, <a href="index.html#frac">frac</a>, <a href="index.html#rolling">rolling</a>, <a href="index.html#seed">seed</a></li>
    </ul>
  </li>
  <li><a href="index.html#selection-helpers">Selection Helpers</a>
    <ul>
      <li><a href="index.html#all">all</a>, <a href="index.html#not">not</a>, <a href="index.html#range">range</a></li>
      <li><a href="index.html#matches">matches</a>, <a href="index.html#startswith">startswith</a>, <a href="index.html#endswith">endswith</a></li>
      <li><a href="index.html#names">names</a></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="table-constructors"><a id="table-constructors">Table Constructors</a></h2>

<p>Methods for creating new table instances.</p>

<hr />
<p><a id="table" href="index.html#table">#</a>
<em>aq</em>.<b>table</b>(<i>columns</i>[, <i>names</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/table/index.js">Source</a></p>

<p>Create a new <a href="https://idl.uw.edu/arquero/api/table">table</a> for a set of named <em>columns</em>, optionally including an array of ordered column <em>names</em>. The <em>columns</em> input can be an object or Map with names for keys and columns for values, or an entry array of <code class="language-plaintext highlighter-rouge">[name, values]</code> tuples.</p>

<p>JavaScript objects have specific key ordering rules: keys are enumerated in the order they are assigned, except for integer keys, which are enumerated first in sorted order. As a result, when using a standard object any <em>columns</em> entries with integer keys are listed first regardless of their order in the object definition. Use the <em>names</em> argument to ensure proper column ordering is respected. Map and entry arrays will preserve name ordering, in which case the <em>names</em> argument is only needed if you wish to specify an ordering different from the <em>columns</em> input.</p>

<p>To bind together columns from multiple tables with the same number of rows, use the table <a href="https://idl.uw.edu/arquero/api/table#assign">assign</a> method. To transform the table, use the various <a href="https://idl.uw.edu/arquero/api/verbs">verb</a> methods.</p>

<ul>
  <li><em>columns</em>: An object or Map providing a named set of column arrays, or an entries array of the form <code class="language-plaintext highlighter-rouge">[[name, values], ...]</code>. Keys are column name strings; the enumeration order of the keys determines the column indices if the <em>names</em> argument is not provided. Column values should be arrays (or array-like values) of identical length.</li>
  <li><em>names</em>: An array of column names, specifying the index order of columns in the table.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create a new table with 2 columns and 3 rows</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span> <span class="na">colA</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">c</span><span class="dl">'</span><span class="p">],</span> <span class="na">colB</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="p">})</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create a new table, preserving column order for integer names</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span> <span class="na">key</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="p">},</span> <span class="p">[</span><span class="dl">'</span><span class="s1">key</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create a new table from a Map instance</span>
<span class="kd">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">()</span>
  <span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">colA</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">c</span><span class="dl">'</span><span class="p">])</span>
  <span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">colB</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">(</span><span class="nx">map</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="from" href="index.html#from">#</a>
<em>aq</em>.<b>from</b>(<i>values</i>[, <i>names</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/table/index.js">Source</a></p>

<p>Create a new <a href="https://idl.uw.edu/arquero/api/table">table</a> from an existing object, such as an array of objects or a set of key-value pairs. For varied JSON formats, see the <a href="index.html#fromJSON"><code class="language-plaintext highlighter-rouge">fromJSON</code></a> method.</p>

<ul>
  <li><em>values</em>: Data values to populate the table. If array-valued or iterable, imports rows for each non-null value, using the provided column names as keys for each row object. If no <em>names</em> are provided, the first non-null object’s own keys are used. If an object or a Map, create a two-column table with columns for the input keys and values.</li>
  <li><em>names</em>: Column names to include. For object or Map inputs, specifies the key and value column names. Otherwise, specifies the keys to look up on each row object.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// from an array, create a new table with two columns and two rows</span>
<span class="c1">// akin to table({ colA: [1, 3], colB: [2, 4] })</span>
<span class="nx">aq</span><span class="p">.</span><span class="k">from</span><span class="p">([</span> <span class="p">{</span> <span class="na">colA</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">colB</span><span class="p">:</span> <span class="mi">2</span> <span class="p">},</span> <span class="p">{</span> <span class="na">colA</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="na">colB</span><span class="p">:</span> <span class="mi">4</span> <span class="p">}</span> <span class="p">])</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// from an object, create a new table with 'key' and 'value columns</span>
<span class="c1">// akin to table({ key: ['a', 'b', 'c'], value: [1, 2, 3] })</span>
<span class="nx">aq</span><span class="p">.</span><span class="k">from</span><span class="p">({</span> <span class="na">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">b</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="na">c</span><span class="p">:</span> <span class="mi">3</span> <span class="p">})</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// from a Map, create a new table with 'key' and 'value' columns</span>
<span class="c1">// akin to table({ key: ['d', 'e', 'f'], value: [4, 5, 6] })</span>
<span class="nx">aq</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="k">new</span> <span class="nb">Map</span><span class="p">([</span> <span class="p">[</span><span class="dl">'</span><span class="s1">d</span><span class="dl">'</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="dl">'</span><span class="s1">e</span><span class="dl">'</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="dl">'</span><span class="s1">f</span><span class="dl">'</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="p">])</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="table-input"><a id="input">Table Input</a></h2>

<p>Methods for loading files and parsing data formats to create new table instances.</p>

<hr />
<p><a id="loadArrow" href="index.html#loadArrow">#</a>
<em>aq</em>.<b>loadArrow</b>(<i>url</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-arrow.js">Source</a></p>

<p>Load a file in the <a href="https://arrow.apache.org/overview/">Apache Arrow</a> IPC binary format from a <em>url</em> and return a Promise for a <a href="https://idl.uw.edu/arquero/api/table">table</a>. Both the <a href="https://arrow.apache.org/docs/format/Columnar.html#ipc-streaming-format">Arrow IPC <code class="language-plaintext highlighter-rouge">stream</code> and <code class="language-plaintext highlighter-rouge">file</code> formats</a> are supported; the format type is determined automatically.</p>

<p>When invoked in the browser, the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> is used to load the <em>url</em>. When invoked in node.js, the <em>url</em> argument can also be a local file path. If the input <em>url</em> string has a network protocol at the beginning (e.g., <code class="language-plaintext highlighter-rouge">'http://'</code>, <code class="language-plaintext highlighter-rouge">'https://'</code>, <em>etc</em>.) it is treated as a URL and <code class="language-plaintext highlighter-rouge">fetch</code> is used. If the <code class="language-plaintext highlighter-rouge">'file://'</code> protocol is used, the rest of the string should be an absolute file path, from which a local file is loaded. Otherwise the input is treated as a path to a local file and opened using the node.js <code class="language-plaintext highlighter-rouge">fs</code> module.</p>

<ul>
  <li><em>url</em> (<code class="language-plaintext highlighter-rouge">string</code>): The url or local file path (node.js only) to load.</li>
  <li><em>options</em>: File loading and Arrow formatting options.
    <ul>
      <li><em>fetch</em> (<a href="https://developer.mozilla.org/en-US/docs/Web/API/RequestInit"><code class="language-plaintext highlighter-rouge">RequestInit</code></a>): Options to pass to the HTTP fetch method when loading a URL.</li>
      <li><em>decompress</em> (<code class="language-plaintext highlighter-rouge">'gzip' | 'deflate' | null</code>): A decompression format to apply. If unspecified, the decompression type is inferred from the file extension (<code class="language-plaintext highlighter-rouge">.gz</code> for <code class="language-plaintext highlighter-rouge">'gzip'</code>, <code class="language-plaintext highlighter-rouge">.zz</code> for <code class="language-plaintext highlighter-rouge">'deflate'</code>). If no matching extension is found, no decompression is performed.</li>
      <li><em>columns</em> (<code class="language-plaintext highlighter-rouge">Select</code>): An ordered set of columns to import. The input may consist of: column name strings, column integer indices, objects with current column names as keys and new column names as values (for renaming), or a selection helper function such as <a href="index.html#all">all</a>, <a href="index.html#not">not</a>, or <a href="index.html#range">range</a>.</li>
      <li><em>useBigInt</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract 64-bit integer types as JavaScript <code class="language-plaintext highlighter-rouge">BigInt</code> values. For Flechette tables, the default is to coerce 64-bit integers to JavaScript numbers and raise an error if the number is out of range. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useDate</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) to convert Arrow date and timestamp values to JavaScript Date objects. Otherwise, numeric timestamps are used. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useDecimalBigInt</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract Arrow decimal-type data as BigInt values, where fractional digits are scaled to integers. Otherwise, decimals are (sometimes lossily) converted to floating-point numbers (default). This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useMap</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to represent Arrow Map data as JavaScript <code class="language-plaintext highlighter-rouge">Map</code> values. For Flechette tables, the default is to produce an array of <code class="language-plaintext highlighter-rouge">[key, value]</code> arrays. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useProxy</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract Arrow Struct values and table row objects using zero-copy proxy objects that extract data from underlying Arrow batches. The proxy objects can improve performance and reduce memory usage, but do not support property enumeration (<code class="language-plaintext highlighter-rouge">Object.keys</code>, <code class="language-plaintext highlighter-rouge">Object.values</code>, <code class="language-plaintext highlighter-rouge">Object.entries</code>) or spreading (<code class="language-plaintext highlighter-rouge">{ ...object }</code>). This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from an Apache Arrow file</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">loadArrow</span><span class="p">(</span><span class="dl">'</span><span class="s1">data/table.arrow</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<hr />
<p><a id="loadCSV" href="index.html#loadCSV">#</a>
<em>aq</em>.<b>loadCSV</b>(<i>url</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-csv.js">Source</a></p>

<p>Load a comma-separated values (CSV) file from a <em>url</em> and return a Promise for a <a href="https://idl.uw.edu/arquero/api/table">table</a>. Delimiters other than commas, such as tabs or pipes (‘|’), can be specified using the <em>options</em> argument. By default, automatic type inference is performed for input values; string values that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior set <em>options.autoType</em> to <code class="language-plaintext highlighter-rouge">false</code>, which will cause all columns to be loaded as strings. To perform custom parsing of input column values, use <em>options.parse</em>.</p>

<p>When invoked in the browser, the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> is used to load the <em>url</em>. When invoked in node.js, the <em>url</em> argument can also be a local file path. If the input <em>url</em> string has a network protocol at the beginning (e.g., <code class="language-plaintext highlighter-rouge">'http://'</code>, <code class="language-plaintext highlighter-rouge">'https://'</code>, <em>etc</em>.) it is treated as a URL and <code class="language-plaintext highlighter-rouge">fetch</code> is used. If the <code class="language-plaintext highlighter-rouge">'file://'</code> protocol is used, the rest of the string should be an absolute file path, from which a local file is loaded. Otherwise the input is treated as a path to a local file and loaded using the node.js <code class="language-plaintext highlighter-rouge">fs</code> module. In either case, stream processing is used to load the data while minimizing memory usage.</p>

<ul>
  <li><em>url</em> (<code class="language-plaintext highlighter-rouge">string</code>): The url or local file (node.js only) to load.</li>
  <li><em>options</em>: File loading and CSV formatting options.
    <ul>
      <li><em>fetch</em> (<a href="https://developer.mozilla.org/en-US/docs/Web/API/RequestInit"><code class="language-plaintext highlighter-rouge">RequestInit</code></a>): Options to pass to the HTTP fetch method when loading a URL.</li>
      <li><em>decompress</em> (<code class="language-plaintext highlighter-rouge">'gzip' | 'deflate' | null</code>): A decompression format to apply. If unspecified, the decompression type is inferred from the file extension (<code class="language-plaintext highlighter-rouge">.gz</code> for <code class="language-plaintext highlighter-rouge">'gzip'</code>, <code class="language-plaintext highlighter-rouge">.zz</code> for <code class="language-plaintext highlighter-rouge">'deflate'</code>). If no matching extension is found, no decompression is performed.</li>
      <li><em>delimiter</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character delimiter string between column values (default <code class="language-plaintext highlighter-rouge">','</code>).</li>
      <li><em>decimal</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character numeric decimal separator (default <code class="language-plaintext highlighter-rouge">'.'</code>).</li>
      <li><em>header</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) to specify the presence of a header row. If <code class="language-plaintext highlighter-rouge">true</code>, indicates the CSV contains a header row with column names. If <code class="language-plaintext highlighter-rouge">false</code>, indicates the CSV does not contain a header row and the columns are given the names <code class="language-plaintext highlighter-rouge">'col1'</code>, <code class="language-plaintext highlighter-rouge">'col2'</code>, etc unless the <em>names</em> option is specified.</li>
      <li><em>names</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names to use for header-less CSV files. This option is ignored if the <em>header</em> option is <code class="language-plaintext highlighter-rouge">true</code>.</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">true</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.</li>
      <li><em>autoMax</em> (<code class="language-plaintext highlighter-rouge">number</code>): Maximum number of initial rows (default <code class="language-plaintext highlighter-rouge">1000</code>) to use for type inference.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from a CSV file</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">loadCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1">data/table.csv</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from a gzip-compressed CSV file</span>
<span class="c1">// the { decompress: 'gzip' } option is inferred from the file extension</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">loadCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1">data/table.csv.gz</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from a tab-delimited file</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">loadCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1">data/table.tsv</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">delimiter</span><span class="p">:</span> <span class="dl">'</span><span class="se">\t</span><span class="dl">'</span> <span class="p">})</span>
</code></pre></div></div>

<hr />
<p><a id="loadFixed" href="index.html#loadFixed">#</a>
<em>aq</em>.<b>loadFixed</b>(<i>url</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-fixed.js">Source</a></p>

<p>Load a fixed-width file from a <em>url</em> and return a Promise for a <a href="https://idl.uw.edu/arquero/api/table">table</a>. By default, automatic type inference is performed for input values; string values that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior set the <em>autoType</em> option to <code class="language-plaintext highlighter-rouge">false</code>, which will cause all columns to be loaded as strings. To perform custom parsing of input column values, use the <em>parse</em> option.</p>

<p>When invoked in the browser, the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> is used to load the <em>url</em>. When invoked in node.js, the <em>url</em> argument can also be a local file path. If the input <em>url</em> string has a network protocol at the beginning (e.g., <code class="language-plaintext highlighter-rouge">'http://'</code>, <code class="language-plaintext highlighter-rouge">'https://'</code>, <em>etc</em>.) it is treated as a URL and <code class="language-plaintext highlighter-rouge">fetch</code> is used. If the <code class="language-plaintext highlighter-rouge">'file://'</code> protocol is used, the rest of the string should be an absolute file path, from which a local file is loaded. Otherwise the input is treated as a path to a local file and loaded using the node.js <code class="language-plaintext highlighter-rouge">fs</code> module. In either case, stream processing is used to load the data while minimizing memory usage.</p>

<ul>
  <li><em>url</em> (<code class="language-plaintext highlighter-rouge">string</code>): The url or local file (node.js only) to load.</li>
  <li><em>options</em>: File loading and fixed-width formatting options.
    <ul>
      <li><em>fetch</em> (<a href="https://developer.mozilla.org/en-US/docs/Web/API/RequestInit"><code class="language-plaintext highlighter-rouge">RequestInit</code></a>): Options to pass to the HTTP fetch method when loading a URL.</li>
      <li><em>decompress</em> (<code class="language-plaintext highlighter-rouge">'gzip' | 'deflate' | null</code>): A decompression format to apply. If unspecified, the decompression type is inferred from the file extension (<code class="language-plaintext highlighter-rouge">.gz</code> for <code class="language-plaintext highlighter-rouge">'gzip'</code>, <code class="language-plaintext highlighter-rouge">.zz</code> for <code class="language-plaintext highlighter-rouge">'deflate'</code>). If no matching extension is found, no decompression is performed.</li>
      <li><em>positions</em> (<code class="language-plaintext highlighter-rouge">[number, number][]</code>): Array of [start, end] indices for fixed-width columns.</li>
      <li><em>widths</em> (<code class="language-plaintext highlighter-rouge">number[]</code>): Array of fixed column widths. This option is ignored if the <em>positions</em> property is specified.</li>
      <li><em>names</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names. The array length should match the length of the <em>positions</em> or <em>widths</em> array. If not specified or shorter than the other array, default column names are generated.</li>
      <li><em>decimal</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character numeric decimal separator (default <code class="language-plaintext highlighter-rouge">'.'</code>).</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.</li>
      <li><em>autoMax</em> (<code class="language-plaintext highlighter-rouge">number</code>): Maximum number of initial rows (default <code class="language-plaintext highlighter-rouge">1000</code>) to use for type inference.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from a fixed-width file</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">loadFixed</span><span class="p">(</span>
  <span class="dl">'</span><span class="s1">data/fixed-width.txt</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">{</span> <span class="na">widths</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="na">names</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">u</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">v</span><span class="dl">'</span><span class="p">]</span> <span class="p">}</span>
<span class="p">);</span>
</code></pre></div></div>

<hr />
<p><a id="loadJSON" href="index.html#loadJSON">#</a>
<em>aq</em>.<b>loadJSON</b>(<i>url</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-json.js">Source</a></p>

<p>Load a JavaScript Object Notation (JSON) file from a <em>url</em> and return a Promise for a <a href="https://idl.uw.edu/arquero/api/table">table</a>. If the <em>type</em> option is unspecified and the loaded JSON is array-valued, an array-of-objects format is assumed. If object-valued, a column-oriented format is assumed. See the <a href="index.html#parseJSON">parseJSON</a> method for format type examples.</p>

<p>By default, string values that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior, set the <em>autoType</em> option to <code class="language-plaintext highlighter-rouge">false</code>. To perform custom parsing of input column values, use the <em>parse</em> option. Auto-type Date parsing is not performed for columns with custom parse options.</p>

<p>When invoked in the browser, the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Fetch API</a> is used to load the <em>url</em>. When invoked in node.js, the <em>url</em> argument can also be a local file path. If the input <em>url</em> string has a network protocol at the beginning (e.g., <code class="language-plaintext highlighter-rouge">'http://'</code>, <code class="language-plaintext highlighter-rouge">'https://'</code>, <em>etc</em>.) it is treated as a URL and <code class="language-plaintext highlighter-rouge">fetch</code> is used. If the <code class="language-plaintext highlighter-rouge">'file://'</code> protocol is used, the rest of the string should be an absolute file path, from which a local file is loaded. Otherwise the input is treated as a path to a local file and loaded using the node.js <code class="language-plaintext highlighter-rouge">fs</code> module. For the <code class="language-plaintext highlighter-rouge">'ndjson'</code> format <em>type</em>, stream processing is used to load the data while minimizing memory usage.</p>

<ul>
  <li><em>url</em> (<code class="language-plaintext highlighter-rouge">string</code>): The url or local file (node.js only) to load.</li>
  <li><em>options</em>: File loading and JSON formatting options.
    <ul>
      <li><em>fetch</em> (<a href="https://developer.mozilla.org/en-US/docs/Web/API/RequestInit"><code class="language-plaintext highlighter-rouge">RequestInit</code></a>): Options to pass to the HTTP fetch method when loading a URL.</li>
      <li><em>decompress</em> (<code class="language-plaintext highlighter-rouge">'gzip' | 'deflate' | null</code>): A decompression format to apply. If unspecified, the decompression type is inferred from the file extension (<code class="language-plaintext highlighter-rouge">.gz</code> for <code class="language-plaintext highlighter-rouge">'gzip'</code>, <code class="language-plaintext highlighter-rouge">.zz</code> for <code class="language-plaintext highlighter-rouge">'deflate'</code>). If no matching extension is found, no decompression is performed.</li>
      <li><em>type</em> (<code class="language-plaintext highlighter-rouge">'columns' | 'rows' | 'ndjson' | null</code>): The JSON format type. One of <code class="language-plaintext highlighter-rouge">'columns'</code> (for an object with named column arrays)<code class="language-plaintext highlighter-rouge">, 'rows'</code> (for an array for row objects), or <code class="language-plaintext highlighter-rouge">'ndjson'</code> for <a href="https://github.com/ndjson/ndjson-spec">newline-delimited JSON</a> rows. For <code class="language-plaintext highlighter-rouge">'ndjson'</code>, each line of text must contain a JSON row object (with no trailing comma) and string properties must not contain any newline characters. If no format type is specified, one of <code class="language-plaintext highlighter-rouge">'rows'</code> or <code class="language-plaintext highlighter-rouge">'columns'</code> is inferred from the structure of the parsed JSON.</li>
      <li><em>columns</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names to include. JSON properties missing from this list are not included in the table.</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data. Applicable to the <code class="language-plaintext highlighter-rouge">'ndjson'</code> type only.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped. Applicable to the <code class="language-plaintext highlighter-rouge">ndjson</code> type only.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.  If <code class="language-plaintext highlighter-rouge">false</code>, automatic date parsing for input JSON strings is disabled.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from a JSON file</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">loadJSON</span><span class="p">(</span><span class="dl">'</span><span class="s1">data/table.json</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from a JSON file, disable Date autoType</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">loadJSON</span><span class="p">(</span><span class="dl">'</span><span class="s1">data/table.json</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">autoType</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
</code></pre></div></div>

<hr />
<p><a id="fromArrow" href="index.html#fromArrow">#</a>
<em>aq</em>.<b>fromArrow</b>(<i>input</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-arrow.js">Source</a></p>

<p>Returns a new <a href="https://idl.uw.edu/arquero/api/table">table</a> backed by <a href="https://arrow.apache.org/">Apache Arrow</a> binary data. The <em>input</em> can be a byte array in the Arrow IPC format, or an instantiated <a href="https://github.com/uwdata/flechette">Flechette</a> or <a href="https://arrow.apache.org/docs/js/">Apache Arrow JS</a> table instance. Binary inputs are decoded using <a href="https://github.com/uwdata/flechette">Flechette</a>.</p>

<p>For many data types, Arquero uses binary-encoded Arrow columns as-is with zero data copying. For dictionary columns, Arquero unpacks columns with <code class="language-plaintext highlighter-rouge">null</code> entries or containing multiple record batches to optimize query performance.</p>

<p>Both the <a href="https://arrow.apache.org/docs/format/Columnar.html#ipc-streaming-format">Arrow IPC <code class="language-plaintext highlighter-rouge">stream</code> and <code class="language-plaintext highlighter-rouge">file</code> formats</a> are supported; the format type is determined automatically. This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadArrow">loadArrow</a>.</p>

<ul>
  <li><em>input</em>: A byte array (e.g., <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer">ArrayBuffer</a> or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array">Uint8Array</a>) in the Arrow IPC format, or a <a href="https://github.com/uwdata/flechette">Flechette</a> or <a href="https://arrow.apache.org/docs/js/">Apache Arrow JS</a> table instance.</li>
  <li><em>options</em>: An Arrow import options object.
    <ul>
      <li><em>columns</em> (<code class="language-plaintext highlighter-rouge">Select</code>): An ordered set of columns to import. The input may consist of: column name strings, column integer indices, objects with current column names as keys and new column names as values (for renaming), or a selection helper function such as <a href="index.html#all">all</a>, <a href="index.html#not">not</a>, or <a href="index.html#range">range</a>.</li>
      <li><em>useBigInt</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract 64-bit integer types as JavaScript <code class="language-plaintext highlighter-rouge">BigInt</code> values. For Flechette tables, the default is to coerce 64-bit integers to JavaScript numbers and raise an error if the number is out of range. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useDate</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) to convert Arrow date and timestamp values to JavaScript Date objects. Otherwise, numeric timestamps are used. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useDecimalBigInt</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract Arrow decimal-type data as BigInt values, where fractional digits are scaled to integers. Otherwise, decimals are (sometimes lossily) converted to floating-point numbers (default). This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useMap</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to represent Arrow Map data as JavaScript <code class="language-plaintext highlighter-rouge">Map</code> values. For Flechette tables, the default is to produce an array of <code class="language-plaintext highlighter-rouge">[key, value]</code> arrays. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useProxy</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract Arrow Struct values and table row objects using zero-copy proxy objects that extract data from underlying Arrow batches. The proxy objects can improve performance and reduce memory usage, but do not support property enumeration (<code class="language-plaintext highlighter-rouge">Object.keys</code>, <code class="language-plaintext highlighter-rouge">Object.values</code>, <code class="language-plaintext highlighter-rouge">Object.entries</code>) or spreading (<code class="language-plaintext highlighter-rouge">{ ...object }</code>). This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// encode input table as Arrow IPC bytes</span>
<span class="kd">const</span> <span class="nx">arrowBytes</span> <span class="o">=</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span>
    <span class="na">x</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="na">y</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">toArrowIPC</span><span class="p">();</span>

<span class="c1">// access the Arrow-encoded data as an Arquero table</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">fromArrow</span><span class="p">(</span><span class="nx">arrowBytes</span><span class="p">);</span>
</code></pre></div></div>

<hr />
<p><a id="fromCSV" href="index.html#parseCSV">#</a>
<em>aq</em>.<b>fromCSV</b>(<i>input</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-csv.js">Source</a></p>

<p>Parse a comma-separated values (CSV) <em>input</em> and return a <a href="https://idl.uw.edu/arquero/api/table">table</a>. Delimiters other than commas, such as tabs or pipes (‘|’), can be specified using the <em>delimiter</em> option. By default, automatic type inference is performed for input values; string values that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior set <em>autoType</em> option to <code class="language-plaintext highlighter-rouge">false</code>, which will cause all columns to be loaded as strings. To perform custom parsing of input column values, use the <em>parse</em> option.</p>

<p>This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadCSV">loadCSV</a>.</p>

<ul>
  <li><em>input</em> (<code class="language-plaintext highlighter-rouge">string</code>): A text string in a delimited-value format.</li>
  <li><em>options</em>: A CSV format options object.
    <ul>
      <li><em>delimiter</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character delimiter string between column values (default <code class="language-plaintext highlighter-rouge">','</code>).</li>
      <li><em>decimal</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character numeric decimal separator (default <code class="language-plaintext highlighter-rouge">'.'</code>).</li>
      <li><em>header</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) to specify the presence of a header row. If <code class="language-plaintext highlighter-rouge">true</code>, indicates the CSV contains a header row with column names. If <code class="language-plaintext highlighter-rouge">false</code>, indicates the CSV does not contain a header row and the columns are given the names <code class="language-plaintext highlighter-rouge">'col1'</code>, <code class="language-plaintext highlighter-rouge">'col2'</code>, etc unless the <em>names</em> option is specified.</li>
      <li><em>names</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names to use for header-less CSV files. This option is ignored if the <em>header</em> option is <code class="language-plaintext highlighter-rouge">true</code>.</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">true</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.</li>
      <li><em>autoMax</em> (<code class="language-plaintext highlighter-rouge">number</code>): Maximum number of initial rows (default <code class="language-plaintext highlighter-rouge">1000</code>) to use for type inference.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create table from an input CSV string</span>
<span class="c1">// akin to table({ a: [1, 3], b: [2, 4] })</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1">a,b</span><span class="se">\n</span><span class="s1">1,2</span><span class="se">\n</span><span class="s1">3,4</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// skip commented lines</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1"># a comment</span><span class="se">\n</span><span class="s1">a,b</span><span class="se">\n</span><span class="s1">1,2</span><span class="se">\n</span><span class="s1">3,4</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">comment</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#</span><span class="dl">'</span> <span class="p">})</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// skip the first line</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1"># a comment</span><span class="se">\n</span><span class="s1">a,b</span><span class="se">\n</span><span class="s1">1,2</span><span class="se">\n</span><span class="s1">3,4</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">skip</span><span class="p">:</span> <span class="mi">1</span> <span class="p">})</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// override autoType with custom parser for column 'a'</span>
<span class="c1">// akin to table({ a: ['00152', '30219'], b: [2, 4] })</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1">a,b</span><span class="se">\n</span><span class="s1">00152,2</span><span class="se">\n</span><span class="s1">30219,4</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">parse</span><span class="p">:</span> <span class="p">{</span> <span class="na">a</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}</span> <span class="p">})</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// parse semi-colon delimited text with comma as decimal separator</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromCSV</span><span class="p">(</span><span class="dl">'</span><span class="s1">a;b</span><span class="se">\n</span><span class="s1">u;-1,23</span><span class="se">\n</span><span class="s1">v;3,45e5</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">delimiter</span><span class="p">:</span> <span class="dl">'</span><span class="s1">;</span><span class="dl">'</span><span class="p">,</span> <span class="na">decimal</span><span class="p">:</span> <span class="dl">'</span><span class="s1">,</span><span class="dl">'</span> <span class="p">})</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create table from an input CSV loaded from 'url'</span>
<span class="c1">// for performant stream-based parsing, use the loadCSV method</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromCSV</span><span class="p">(</span><span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">text</span><span class="p">()))</span>
</code></pre></div></div>

<hr />
<p><a id="fromFixed" href="index.html#fromFixed">#</a>
<em>aq</em>.<b>fromFixed</b>(<i>input</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-fixed.js">Source</a></p>

<p>Parse a fixed-width file <em>input</em> and a <a href="https://idl.uw.edu/arquero/api/table">table</a>. By default, automatic type inference is performed for input values; string values that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior set <em>options.autoType</em> to <code class="language-plaintext highlighter-rouge">false</code>, which will cause all columns to be loaded as strings. To perform custom parsing of input column values, use <em>options.parse</em>.</p>

<p>This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadFixed">loadFixed</a>.</p>

<ul>
  <li><em>input</em> (<code class="language-plaintext highlighter-rouge">string</code>): A text string in a fixed-width format.</li>
  <li><em>options</em>: A fixed-width format options object.
    <ul>
      <li><em>positions</em> (<code class="language-plaintext highlighter-rouge">[number, number][]</code>): Array of [start, end] indices for fixed-width columns.</li>
      <li><em>widths</em> (<code class="language-plaintext highlighter-rouge">number[]</code>): Array of fixed column widths. This option is ignored if the <em>positions</em> property is specified.</li>
      <li><em>names</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names. The array length should match the length of the <em>positions</em> or <em>widths</em> array. If not specified or shorter than the other array, default column names are generated.</li>
      <li><em>decimal</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character numeric decimal separator (default <code class="language-plaintext highlighter-rouge">'.'</code>).</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.</li>
      <li><em>autoMax</em> (<code class="language-plaintext highlighter-rouge">number</code>): Maximum number of initial rows (default <code class="language-plaintext highlighter-rouge">1000</code>) to use for type inference.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create table from an input fixed-width string</span>
<span class="c1">// akin to table({ u: ['a', 'b'], v: [1, 2] })</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromFixed</span><span class="p">(</span><span class="dl">'</span><span class="s1">a1</span><span class="se">\n</span><span class="s1">b2</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">widths</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="na">names</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">u</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">v</span><span class="dl">'</span><span class="p">]</span> <span class="p">})</span>
</code></pre></div></div>

<hr />
<p><a id="fromJSON" href="index.html#fromJSON">#</a>
<em>aq</em>.<b>fromJSON</b>(<i>input</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-json.js">Source</a></p>

<p>Parse JavaScript Object Notation (JSON) <em>input</em> into and return a <a href="https://idl.uw.edu/arquero/api/table">table</a>. String values in JSON column arrays that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior, set the <em>autoType</em> option to <code class="language-plaintext highlighter-rouge">false</code>. To perform custom parsing of input column values, use the <em>parse</em> option. Auto-type Date parsing is not performed for columns with custom parse options.</p>

<p>This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadJSON">loadJSON</a>. Additionally, the <a href="index.html#table">table</a> reads pre-parsed column-oriented JSON data into an Arquero table without type inference, while the <a href="index.html#from">from</a> method similarly maps pre-parsed row-oriented JSON data into an Arquero table.</p>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td><em>input</em> (<code class="language-plaintext highlighter-rouge">string</code></td>
          <td><code class="language-plaintext highlighter-rouge">object[]</code></td>
          <td><code class="language-plaintext highlighter-rouge">object</code>): A string in a supported JSON format or pre-parsed JSON data.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><em>options</em>: A JSON format options object:
    <ul>
      <li><em>type</em> (<code class="language-plaintext highlighter-rouge">'columns' | 'rows' | 'ndjson' | null</code>): The JSON format type. One of <code class="language-plaintext highlighter-rouge">'columns'</code> (for an object with named column arrays)<code class="language-plaintext highlighter-rouge">, 'rows'</code> (for an array for row objects), or <code class="language-plaintext highlighter-rouge">'ndjson'</code> for <a href="https://github.com/ndjson/ndjson-spec">newline-delimited JSON</a> rows. For <code class="language-plaintext highlighter-rouge">'ndjson'</code>, each line of text must contain a JSON row object (with no trailing comma) and string properties must not contain any newline characters. If no format type is specified, one of <code class="language-plaintext highlighter-rouge">'rows'</code> or <code class="language-plaintext highlighter-rouge">'columns'</code> is inferred from the structure of the parsed JSON.</li>
      <li><em>columns</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names to include. JSON properties missing from this list are not included in the table.</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data. Applicable to the <code class="language-plaintext highlighter-rouge">'ndjson'</code> type only.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped. Applicable to the <code class="language-plaintext highlighter-rouge">ndjson</code> type only.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.  If <code class="language-plaintext highlighter-rouge">false</code>, automatic date parsing for input JSON strings is disabled.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<p><em>JSON Format Types</em></p>

<p><code class="language-plaintext highlighter-rouge">'columns'</code>: column-oriented JSON as an object-of-arrays.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"c"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">'rows'</code>: row-oriented JSON as an array-of-objects.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">'ndjson'</code>: newline-delimited JSON as individual objects separated by newline.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create table from an input JSON string</span>
<span class="c1">// akin to table({ a: [1, 3], b: [2, 4] })</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">(</span><span class="dl">'</span><span class="s1">{"a":[1,3],"b":[2,4]}</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create table from an input JSON string loaded from 'url'</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">(</span><span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">text</span><span class="p">()))</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create table from an input JSON object loaded from 'url'</span>
<span class="c1">// disable autoType Date parsing</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromJSON</span><span class="p">(</span><span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">()),</span> <span class="p">{</span> <span class="na">autoType</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>
</code></pre></div></div>

<hr />
<p><a id="fromArrowStream" href="index.html#fromArrowStream">#</a>
<em>aq</em>.<b>fromArrowStream</b>(<i>stream</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-arrow.js">Source</a></p>

<p>Returns a Promise to a new <a href="https://idl.uw.edu/arquero/api/table">table</a> backed by <a href="https://arrow.apache.org/">Apache Arrow</a> binary data. The <em>stream</em> must be a ReadableStream of bytes, which is then decoded using <a href="https://github.com/uwdata/flechette">Flechette</a>.</p>

<p>For many data types, Arquero uses binary-encoded Arrow columns as-is with zero data copying. For dictionary columns, Arquero unpacks columns with <code class="language-plaintext highlighter-rouge">null</code> entries or containing multiple record batches to optimize query performance.</p>

<p>Both the <a href="https://arrow.apache.org/docs/format/Columnar.html#ipc-streaming-format">Arrow IPC <code class="language-plaintext highlighter-rouge">stream</code> and <code class="language-plaintext highlighter-rouge">file</code> formats</a> are supported; the format type is determined automatically. This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadArrow">loadArrow</a>.</p>

<ul>
  <li><em>stream</em>: A <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream">ReadableStream</a> of bytes.</li>
  <li><em>options</em>: An Arrow import options object.
    <ul>
      <li><em>columns</em> (<code class="language-plaintext highlighter-rouge">Select</code>): An ordered set of columns to import. The input may consist of: column name strings, column integer indices, objects with current column names as keys and new column names as values (for renaming), or a selection helper function such as <a href="index.html#all">all</a>, <a href="index.html#not">not</a>, or <a href="index.html#range">range</a>.</li>
      <li><em>useBigInt</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract 64-bit integer types as JavaScript <code class="language-plaintext highlighter-rouge">BigInt</code> values. For Flechette tables, the default is to coerce 64-bit integers to JavaScript numbers and raise an error if the number is out of range. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useDate</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) to convert Arrow date and timestamp values to JavaScript Date objects. Otherwise, numeric timestamps are used. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useDecimalBigInt</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract Arrow decimal-type data as BigInt values, where fractional digits are scaled to integers. Otherwise, decimals are (sometimes lossily) converted to floating-point numbers (default). This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useMap</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to represent Arrow Map data as JavaScript <code class="language-plaintext highlighter-rouge">Map</code> values. For Flechette tables, the default is to produce an array of <code class="language-plaintext highlighter-rouge">[key, value]</code> arrays. This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
      <li><em>useProxy</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">false</code>) to extract Arrow Struct values and table row objects using zero-copy proxy objects that extract data from underlying Arrow batches. The proxy objects can improve performance and reduce memory usage, but do not support property enumeration (<code class="language-plaintext highlighter-rouge">Object.keys</code>, <code class="language-plaintext highlighter-rouge">Object.values</code>, <code class="language-plaintext highlighter-rouge">Object.entries</code>) or spreading (<code class="language-plaintext highlighter-rouge">{ ...object }</code>). This option is only applied when parsing IPC binary data, otherwise the settings of the provided table instance are used.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// load table from an Apache Arrow file</span>
<span class="kd">const</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">fromArrowStream</span><span class="p">(</span><span class="nx">byteStream</span><span class="p">);</span>
</code></pre></div></div>

<hr />
<p><a id="fromCSVStream" href="index.html#fromCSVStream">#</a>
<em>aq</em>.<b>fromCSVStream</b>(<i>stream</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-csv.js">Source</a></p>

<p>Parse a comma-separated values (CSV) <em>stream</em> and return a Promise to a <a href="https://idl.uw.edu/arquero/api/table">table</a>. Delimiters other than commas, such as tabs or pipes (‘|’), can be specified using the <em>delimiter</em> option. By default, automatic type inference is performed for input values; string values that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior set <em>autoType</em> option to <code class="language-plaintext highlighter-rouge">false</code>, which will cause all columns to be loaded as strings. To perform custom parsing of input column values, use the <em>parse</em> option.</p>

<p>This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadCSV">loadCSV</a>.</p>

<ul>
  <li><em>stream</em>: A <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream">ReadableStream</a> of text.</li>
  <li><em>options</em>: A CSV format options object.
    <ul>
      <li><em>delimiter</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character delimiter string between column values (default <code class="language-plaintext highlighter-rouge">','</code>).</li>
      <li><em>decimal</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character numeric decimal separator (default <code class="language-plaintext highlighter-rouge">'.'</code>).</li>
      <li><em>header</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) to specify the presence of a header row. If <code class="language-plaintext highlighter-rouge">true</code>, indicates the CSV contains a header row with column names. If <code class="language-plaintext highlighter-rouge">false</code>, indicates the CSV does not contain a header row and the columns are given the names <code class="language-plaintext highlighter-rouge">'col1'</code>, <code class="language-plaintext highlighter-rouge">'col2'</code>, etc unless the <em>names</em> option is specified.</li>
      <li><em>names</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names to use for header-less CSV files. This option is ignored if the <em>header</em> option is <code class="language-plaintext highlighter-rouge">true</code>.</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">true</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.</li>
      <li><em>autoMax</em> (<code class="language-plaintext highlighter-rouge">number</code>): Maximum number of initial rows (default <code class="language-plaintext highlighter-rouge">1000</code>) to use for type inference.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// parse CSV from a compressed input stream</span>
<span class="c1">// (these stream transforms are performed internally by loadCSV)</span>
<span class="kd">const</span> <span class="nx">stream</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">pipeThrough</span><span class="p">(</span><span class="k">new</span> <span class="nx">DecompressionStream</span><span class="p">(</span><span class="dl">'</span><span class="s1">gzip</span><span class="dl">'</span><span class="p">))</span> <span class="c1">// decompress bytes</span>
  <span class="p">.</span><span class="nx">pipeThrough</span><span class="p">(</span><span class="k">new</span> <span class="nx">TextDecoderStream</span><span class="p">());</span> <span class="c1">// map bytes to strings</span>
<span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">fromCSVStream</span><span class="p">(</span><span class="nx">stream</span><span class="p">);</span>
</code></pre></div></div>

<hr />
<p><a id="fromFixedStream" href="index.html#fromFixedStream">#</a>
<em>aq</em>.<b>fromFixedStream</b>(<i>stream</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/from-fixed.js">Source</a></p>

<p>Parse a fixed-width file <em>stream</em> and return a Promise to a <a href="https://idl.uw.edu/arquero/api/table">table</a>. By default, automatic type inference is performed for input values; string values that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior set <em>options.autoType</em> to <code class="language-plaintext highlighter-rouge">false</code>, which will cause all columns to be loaded as strings. To perform custom parsing of input column values, use <em>options.parse</em>.</p>

<p>This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadFixed">loadFixed</a>.</p>

<ul>
  <li><em>stream</em>: A <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream">ReadableStream</a> of text.</li>
  <li><em>options</em>: A fixed-width format options object.
    <ul>
      <li><em>positions</em> (<code class="language-plaintext highlighter-rouge">[number, number][]</code>): Array of [start, end] indices for fixed-width columns.</li>
      <li><em>widths</em> (<code class="language-plaintext highlighter-rouge">number[]</code>): Array of fixed column widths. This option is ignored if the <em>positions</em> property is specified.</li>
      <li><em>names</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names. The array length should match the length of the <em>positions</em> or <em>widths</em> array. If not specified or shorter than the other array, default column names are generated.</li>
      <li><em>decimal</em> (<code class="language-plaintext highlighter-rouge">string</code>): A single-character numeric decimal separator (default <code class="language-plaintext highlighter-rouge">'.'</code>).</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.</li>
      <li><em>autoMax</em> (<code class="language-plaintext highlighter-rouge">number</code>): Maximum number of initial rows (default <code class="language-plaintext highlighter-rouge">1000</code>) to use for type inference.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// parse fixed width text from a compressed input stream</span>
<span class="c1">// (these stream transforms are performed internally by loadFixed)</span>
<span class="kd">const</span> <span class="nx">stream</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">body</span><span class="p">))</span>
  <span class="p">.</span><span class="nx">pipeThrough</span><span class="p">(</span><span class="k">new</span> <span class="nx">DecompressionStream</span><span class="p">(</span><span class="dl">'</span><span class="s1">gzip</span><span class="dl">'</span><span class="p">))</span> <span class="c1">// decompress bytes</span>
  <span class="p">.</span><span class="nx">pipeThrough</span><span class="p">(</span><span class="k">new</span> <span class="nx">TextDecoderStream</span><span class="p">());</span> <span class="c1">// map bytes to strings</span>
<span class="k">await</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">fromFixedStream</span><span class="p">(</span><span class="nx">stream</span><span class="p">);</span>
</code></pre></div></div>

<hr />
<p><a id="parseJSONStream" href="index.html#parseJSONStream">#</a>
<em>aq</em>.<b>parseJSONStream</b>(<i>stream</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/format/parse-json.js">Source</a></p>

<p>Parse a JavaScript Object Notation (JSON) <em>stream</em> and return a Promise to a <a href="https://idl.uw.edu/arquero/api/table">table</a>. String values in JSON column arrays that match the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO standard date format</a> are parsed into JavaScript Date objects. To disable this behavior, set the <em>autoType</em> option to <code class="language-plaintext highlighter-rouge">false</code>. To perform custom parsing of input column values, use the <em>parse</em> option. Auto-type Date parsing is not performed for columns with custom parse options.</p>

<p>This method performs parsing only. To specify a URL or file to load, use <a href="index.html#loadJSON">loadJSON</a>. Additionally, the <a href="index.html#table">table</a> reads pre-parsed column-oriented JSON data into an Arquero table without type inference, while the <a href="index.html#from">from</a> method similarly maps pre-parsed row-oriented JSON data into an Arquero table.</p>

<ul>
  <li><em>input</em>: A <a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream">ReadableStream</a> of text.</li>
  <li><em>options</em>: A JSON format options object:
    <ul>
      <li><em>type</em> (<code class="language-plaintext highlighter-rouge">'columns' | 'rows' | 'ndjson' | null</code>): The JSON format type. One of <code class="language-plaintext highlighter-rouge">'columns'</code> (for an object with named column arrays)<code class="language-plaintext highlighter-rouge">, 'rows'</code> (for an array for row objects), or <code class="language-plaintext highlighter-rouge">'ndjson'</code> for <a href="https://github.com/ndjson/ndjson-spec">newline-delimited JSON</a> rows. For <code class="language-plaintext highlighter-rouge">'ndjson'</code>, each line of text must contain a JSON row object (with no trailing comma) and string properties must not contain any newline characters. If no format type is specified, one of <code class="language-plaintext highlighter-rouge">'rows'</code> or <code class="language-plaintext highlighter-rouge">'columns'</code> is inferred from the structure of the parsed JSON.</li>
      <li><em>columns</em> (<code class="language-plaintext highlighter-rouge">string[]</code>): An array of column names to include. JSON properties missing from this list are not included in the table.</li>
      <li><em>skip</em> (<code class="language-plaintext highlighter-rouge">number</code>): The number of lines to skip (default <code class="language-plaintext highlighter-rouge">0</code>) before reading data. Applicable to the <code class="language-plaintext highlighter-rouge">'ndjson'</code> type only.</li>
      <li><em>comment</em> (<code class="language-plaintext highlighter-rouge">string</code>): A string used to identify comment lines. Any lines that start with the comment pattern are skipped. Applicable to the <code class="language-plaintext highlighter-rouge">ndjson</code> type only.</li>
      <li><em>autoType</em> (<code class="language-plaintext highlighter-rouge">boolean</code>): Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) for automatic type inference.  If <code class="language-plaintext highlighter-rouge">false</code>, automatic date parsing for input JSON strings is disabled.</li>
      <li><em>parse</em> (<code class="language-plaintext highlighter-rouge">Record&lt;string, function&gt;</code>): Object of column parsing options. The object keys should be column names. The object values should be parsing functions to invoke to transform values upon input.</li>
    </ul>
  </li>
</ul>

<p><em>JSON Format Types</em></p>

<p><code class="language-plaintext highlighter-rouge">'columns'</code>: column-oriented JSON as an object-of-arrays.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="s2">"c"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">'rows'</code>: row-oriented JSON as an array-of-objects.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">'ndjson'</code>: newline-delimited JSON as individual objects separated by newline.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">}</span><span class="w">
</span><span class="p">{</span><span class="nl">"colA"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c"</span><span class="p">,</span><span class="w"> </span><span class="nl">"colB"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create table from an input text stream in NDJSON format</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">fromJSONStream</span><span class="p">(</span><span class="nx">textStream</span><span class="p">,</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ndjson</span><span class="dl">'</span> <span class="p">})</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="expression-helpers"><a id="expression-helpers">Expression Helpers</a></h2>

<p>Methods for invoking or modifying table expressions.</p>

<hr />
<p><a id="op" href="index.html#op">#</a>
<em>aq</em>.<b>op</b> · <a href="https://github.com/uwdata/arquero/blob/master/src/op/op-api.js">Source</a></p>

<p>All table expression operations, including standard functions, aggregate functions, and window functions. See the <a href="https://idl.uw.edu/arquero/api/op">Operations API Reference</a> for documentation of all available functions.</p>

<hr />
<p><a id="agg" href="index.html#agg">#</a>
<em>aq</em>.<b>agg</b>(<i>table</i>, <i>expression</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/verbs/helpers/agg.js">Source</a></p>

<p>Compute a single aggregate value for a table. This method is a convenient shortcut for ungrouping a table, applying a <a href="https://idl.uw.edu/arquero/api/verbs#rollup">rollup</a> verb for a single aggregate expression, and extracting the resulting aggregate value.</p>

<ul>
  <li><em>table</em>: An Arquero table.</li>
  <li><em>expression</em>: An aggregate-valued table expression. Aggregate functions are permitted, and will take into account any <a href="index.html#orderby">orderby</a> settings. Window functions are not permitted and any <a href="index.html#groupby">groupby</a> settings will be ignored.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">agg</span><span class="p">(</span><span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span> <span class="na">a</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">}),</span> <span class="nx">op</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">))</span> <span class="c1">// 3</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">agg</span><span class="p">(</span><span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span> <span class="na">a</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="p">}),</span> <span class="nx">d</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nx">op</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">a</span><span class="p">),</span> <span class="nx">op</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">)])</span> <span class="c1">// [1, 5]</span>
</code></pre></div></div>

<hr />
<p><a id="escape" href="index.html#escape">#</a>
<em>aq</em>.<b>escape</b>(<i>value</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/escape.js">Source</a></p>

<p>Annotate a JavaScript function or <em>value</em> to bypass Arquero’s default table expression handling. Escaped values enable the direct use of JavaScript functions to process row data: no internal parsing or code generation is performed, and so <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">closures</a> and arbitrary function invocations are supported. Escaped values provide a lightweight alternative to <a href="https://idl.uw.edu/arquero/api/table#params">table params</a> and <a href="https://idl.uw.edu/arquero/api/extensibility#addFunction">function registration</a> to access variables in enclosing scopes.</p>

<p>An escaped value can be applied anywhere Arquero accepts <a href="https://idl.uw.edu/arquero/api/expressions#table">single-table table expressions</a>, including the <a href="https://idl.uw.edu/arquero/api/verbs#derive">derive</a>, <a href="https://idl.uw.edu/arquero/api/verbs#filter">filter</a>, and <a href="https://idl.uw.edu/arquero/api/verbs#spread">spread</a> verbs. In addition, any of the <a href="https://idl.uw.edu/arquero/api/op#functions">standard <code class="language-plaintext highlighter-rouge">op</code> functions</a> can be used within an escaped function. However, aggregate and window <code class="language-plaintext highlighter-rouge">op</code> functions are not supported. Also note that using escaped values will break <a href="https://github.com/uwdata/arquero-worker">serialization of Arquero queries to worker threads</a>.</p>

<ul>
  <li><em>value</em>: A literal value or a function that is passed a row object and params object as input. Aggregate and window <code class="language-plaintext highlighter-rouge">op</code> functions are not permitted.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// filter based on a variable defined in the enclosing scope</span>
<span class="kd">const</span> <span class="nx">thresh</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span> <span class="na">a</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="na">b</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">aq</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">thresh</span><span class="p">))</span>
  <span class="c1">// { a: [1, 4], b: [1, 2] }</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// apply a parsing function defined in the enclosing scope</span>
<span class="kd">const</span> <span class="nx">parseMDY</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">timeParse</span><span class="p">(</span><span class="dl">'</span><span class="s1">%m/%d/%Y</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span> <span class="na">date</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">1/1/2000</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">06/01/2010</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">12/10/2020</span><span class="dl">'</span><span class="p">]</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">derive</span><span class="p">({</span> <span class="na">date</span><span class="p">:</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">parseMDY</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">date</span><span class="p">))</span> <span class="p">})</span>
  <span class="c1">// { date: [new Date(2000,0,1), new Date(2010,5,1), new Date(2020,11,10)] }</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// spread results from an escaped function that returns an array</span>
<span class="kd">const</span> <span class="nx">denom</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">table</span><span class="p">({</span> <span class="na">a</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">spread</span><span class="p">(</span>
    <span class="p">{</span> <span class="na">a</span><span class="p">:</span> <span class="nx">aq</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">a</span> <span class="o">/</span> <span class="nx">denom</span><span class="p">),</span> <span class="nx">d</span><span class="p">.</span><span class="nx">a</span> <span class="o">%</span> <span class="nx">denom</span><span class="p">])</span> <span class="p">},</span>
    <span class="p">{</span> <span class="na">as</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">mod</span><span class="dl">'</span><span class="p">]</span> <span class="p">}</span>
  <span class="p">)</span>
  <span class="c1">// { div: [0, 1, 2], mod: [1, 0, 1] }</span>
</code></pre></div></div>

<hr />
<p><a id="bin" href="index.html#bin">#</a>
<em>aq</em>.<b>bin</b>(<i>name</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/bin.js">Source</a></p>

<p>Generate a table expression that performs uniform binning of number values. The resulting string can be used as part of the input to table transformation verbs.</p>

<ul>
  <li><em>name</em>: The name of the column to bin.</li>
  <li><em>options</em>: A binning scheme options object:
    <ul>
      <li><em>maxbins</em>: The maximum number of bins.</li>
      <li><em>minstep</em>: The minimum step size between bins.</li>
      <li><em>nice</em>: Boolean flag (default <code class="language-plaintext highlighter-rouge">true</code>) indicating if bins should snap to “nice” human-friendly values such as multiples of ten.</li>
      <li><em>offset</em>: Step offset for bin boundaries. The default (<code class="language-plaintext highlighter-rouge">0</code>) floors to the lower bin boundary. A value of <code class="language-plaintext highlighter-rouge">1</code> snaps one step higher to the upper bin boundary, and so on.</li>
      <li><em>step</em>: The exact step size to use between bins. If specified, the <em>maxbins</em> and <em>minstep</em> options are ignored.</li>
    </ul>
  </li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nx">aq</span><span class="p">.</span><span class="nx">bin</span><span class="p">(</span><span class="dl">'</span><span class="s1">colA</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">maxbins</span><span class="p">:</span> <span class="mi">20</span> <span class="p">})</span>
</code></pre></div></div>

<hr />
<p><a id="collate" href="index.html#collate">#</a>
<em>aq</em>.<b>collate</b>(<i>expr</i>, <i>comparator</i>[, <i>options</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/collate.js">Source</a></p>

<p>Annotate a table expression with collation metadata, indicating how expression values should be compared and sorted. The <a href="https://idl.uw.edu/arquero/api/verbs#orderby">orderby</a> verb uses collation metadata to determine sort order. The collate helper is particularly useful for locale-specific string comparisons. The collation information can either take the form a standard two-argument comparator function, or as locale and option arguments compatible with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Collator"><code class="language-plaintext highlighter-rouge">Intl.Collator</code></a>.</p>

<ul>
  <li><em>expr</em>: The table expression to annotate with collation metadata.</li>
  <li><em>comparator</em>: A comparator function or the locale(s) to use. For locales, both string (e.g., <code class="language-plaintext highlighter-rouge">'de'</code>, <code class="language-plaintext highlighter-rouge">'tr'</code>, etc.) and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Locale"><code class="language-plaintext highlighter-rouge">Intl.Locale</code></a> objects (or an array with either) is supported.</li>
  <li><em>options</em>: Collation options compatible with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Collator"><code class="language-plaintext highlighter-rouge">Intl.Collator</code></a>. This argument only applies if locales are provided as the second argument.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// order colA using a German locale</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">collate</span><span class="p">(</span><span class="dl">'</span><span class="s1">colA</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">de</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// order colA using a provided comparator function</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">collate</span><span class="p">(</span><span class="dl">'</span><span class="s1">colA</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Intl</span><span class="p">.</span><span class="nx">Collator</span><span class="p">(</span><span class="dl">'</span><span class="s1">de</span><span class="dl">'</span><span class="p">).</span><span class="nx">compare</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="desc" href="index.html#desc">#</a>
<em>aq</em>.<b>desc</b>(<i>expr</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/desc.js">Source</a></p>

<p>Annotate a table expression (<em>expr</em>) to indicate descending sort order.</p>

<ul>
  <li><em>expr</em>: The table expression to annotate.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// sort colA in descending order</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">desc</span><span class="p">(</span><span class="dl">'</span><span class="s1">colA</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// sort colA in descending order of lower case values</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">desc</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">op</span><span class="p">.</span><span class="nx">lower</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">colA</span><span class="p">))</span>
</code></pre></div></div>

<hr />
<p><a id="frac" href="index.html#frac">#</a>
<em>aq</em>.<b>frac</b>(<i>fraction</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/frac.js">Source</a></p>

<p>Generate a table expression that computes the number of rows corresponding to a given fraction for each group. The resulting string can be used as part of the input to the <a href="https://idl.uw.edu/arquero/api/verbs#sample">sample</a> verb.</p>

<ul>
  <li><em>fraction</em>: The fractional value.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nx">aq</span><span class="p">.</span><span class="nx">frac</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="rolling" href="index.html#rolling">#</a>
<em>aq</em>.<b>rolling</b>(<i>expr</i>[, <i>frame</i>, <i>includePeers</i>]) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/rolling.js">Source</a></p>

<p>Annotate a table expression to compute rolling aggregate or window functions within a sliding window frame. For example, to specify a rolling 7-day average centered on the current day, call <em>rolling</em> with a frame value of [-3, 3].</p>

<ul>
  <li><em>expr</em>: The table expression to annotate.</li>
  <li><em>frame</em>:The sliding window frame offsets. Each entry indicates an offset from the current value. If an entry is non-finite, the frame will be unbounded in that direction, including all preceding or following values. If unspecified or <code class="language-plaintext highlighter-rouge">null</code>, the default frame <code class="language-plaintext highlighter-rouge">[-Infinity, 0]</code> includes the current values and all preceding values.</li>
  <li><em>includePeers</em>: Boolean flag indicating if the sliding window frame should ignore peer (tied) values. If <code class="language-plaintext highlighter-rouge">false</code> (the default), the window frame boundaries are insensitive to peer values. If <code class="language-plaintext highlighter-rouge">true</code>, the window frame expands to include all peers. This parameter only affects operations that depend on the window frame: namely <a href="https://idl.uw.edu/arquero/api/op#aggregate-functions">aggregate functions</a> and the <a href="https://idl.uw.edu/arquero/api/op#first_value">first_value</a>, <a href="https://idl.uw.edu/arquero/api/op#last_value">last_value</a>, and <a href="https://idl.uw.edu/arquero/api/op#last_values">nth_value</a> window functions.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// cumulative sum, with an implicit frame of [-Infinity, 0]</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">rolling</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">op</span><span class="p">.</span><span class="nx">sum</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">colA</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// centered 7-day moving average, assuming one value per day</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">rolling</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">op</span><span class="p">.</span><span class="nx">mean</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">colA</span><span class="p">),</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// retrieve last value in window frame, including peers (ties)</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">rolling</span><span class="p">(</span><span class="nx">d</span> <span class="o">=&gt;</span> <span class="nx">op</span><span class="p">.</span><span class="nx">last_value</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">colA</span><span class="p">),</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="kc">true</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="seed" href="index.html#seed">#</a>
<em>aq</em>.<b>seed</b>(<i>value</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/util/random.js">Source</a></p>

<p>Set a seed value for random number generation. If the seed is a valid number, a 32-bit <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">linear congruential generator</a> with the given seed will be used to generate random values. If the seed is <code class="language-plaintext highlighter-rouge">null</code>, <code class="language-plaintext highlighter-rouge">undefined</code>, or not a valid number, the random number generator will revert to <code class="language-plaintext highlighter-rouge">Math.random</code>.</p>

<ul>
  <li><em>seed</em>: The random seed value. Should either be an integer or a fraction between 0 and 1.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// set random seed as an integer</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// set random seed as a fraction, maps to floor(fraction * (2 ** 32))</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">seed</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// revert to using Math.random</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">seed</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="selection-helpers"><a id="selection-helpers">Selection Helpers</a></h2>

<p>Methods for selecting columns. The result of these methods can be passed as arguments to <a href="https://idl.uw.edu/arquero/api/verbs#select">select</a>, <a href="https://idl.uw.edu/arquero/api/verbs#groupby">groupby</a>, <a href="https://idl.uw.edu/arquero/api/verbs#join">join</a> and other transformation verbs.</p>

<hr />
<p><a id="all" href="index.html#all">#</a>
<em>aq</em>.<b>all</b>() · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/selection.js">Source</a></p>

<p>Select all columns in a table. Returns a function-valued selection compatible with <a href="https://idl.uw.edu/arquero/api/verbs#select">select</a>.</p>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">all</span><span class="p">()</span>
</code></pre></div></div>

<hr />
<p><a id="not" href="index.html#not">#</a>
<em>aq</em>.<b>not</b>(<i>selection</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/selection.js">Source</a></p>

<p>Negate a column <em>selection</em>, selecting all other columns in a table. Returns a function-valued selection compatible with <a href="https://idl.uw.edu/arquero/api/verbs#select">select</a>.</p>

<ul>
  <li><em>selection</em>: The selection to negate. May be a column name, column index, array of either, or a selection function (e.g., from <a href="index.html#range">range</a>).</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="dl">'</span><span class="s1">colA</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">colB</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">not</span><span class="p">(</span><span class="nx">aq</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</code></pre></div></div>

<hr />
<p><a id="range" href="index.html#range">#</a>
<em>aq</em>.<b>range</b>(<i>start</i>, <i>stop</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/selection.js">Source</a></p>

<p>Select a contiguous range of columns. Returns a function-valued selection compatible with <a href="https://idl.uw.edu/arquero/api/verbs#select">select</a>.</p>

<ul>
  <li><em>start</em>: The name or integer index of the first selected column.</li>
  <li><em>stop</em>: The name or integer index of the last selected column.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="dl">'</span><span class="s1">colB</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">colE</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="matches" href="index.html#matches">#</a>
<em>aq</em>.<b>matches</b>(<i>pattern</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/selection.js">Source</a></p>

<p>Select all columns whose names match a pattern. Returns a function-valued selection compatible with <a href="https://idl.uw.edu/arquero/api/verbs#select">select</a>.</p>

<ul>
  <li><em>pattern</em>: A string or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">regular expression</a> pattern to match.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// contains the string 'col'</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="dl">'</span><span class="s1">col</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// has 'a', 'b', or 'c' as the first character (case-insensitve)</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="sr">/^</span><span class="se">[</span><span class="sr">abc</span><span class="se">]</span><span class="sr">/i</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="startswith" href="index.html#startswith">#</a>
<em>aq</em>.<b>startswith</b>(<i>string</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/selection.js">Source</a></p>

<p>Select all columns whose names start with a string. Returns a function-valued selection compatible with <a href="https://idl.uw.edu/arquero/api/verbs#select">select</a>.</p>

<ul>
  <li><em>string</em>: The string to match at the start of the column name.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">startswith</span><span class="p">(</span><span class="dl">'</span><span class="s1">prefix_</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="endswith" href="index.html#endswith">#</a>
<em>aq</em>.<b>endswith</b>(<i>string</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/selection.js">Source</a></p>

<p>Select all columns whose names end with a string. Returns a function-valued selection compatible with <a href="https://idl.uw.edu/arquero/api/verbs#select">select</a>.</p>

<ul>
  <li><em>string</em>: The string to match at the end of the column name.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">aq</span><span class="p">.</span><span class="nx">endswith</span><span class="p">(</span><span class="dl">'</span><span class="s1">_suffix</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<hr />
<p><a id="names" href="index.html#names">#</a>
<em>aq</em>.<b>names</b>(<i>…names</i>) · <a href="https://github.com/uwdata/arquero/blob/master/src/helpers/names.js">Source</a></p>

<p>Select columns by index and rename them to the provided <em>names</em>. Returns a selection helper function that takes a table as input and produces a rename map as output. If the number of provided names is less than the number of table columns, the rename map will include entries for the provided names only. If the number of table columns is less than then number of provided names, the rename map will include only entries that cover the existing columns.</p>

<ul>
  <li><em>names</em>: An ordered set of strings to use as the new column names.</li>
</ul>

<p><em>Examples</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// helper to rename the first three columns to 'a', 'b', 'c'</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">names</span><span class="p">(</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">c</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// names can also be passed as arrays</span>
<span class="nx">aq</span><span class="p">.</span><span class="nx">names</span><span class="p">([</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">c</span><span class="dl">'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// rename the first three columns, all other columns remain as-is</span>
<span class="nx">table</span><span class="p">.</span><span class="nx">rename</span><span class="p">(</span><span class="nx">aq</span><span class="p">.</span><span class="nx">names</span><span class="p">([</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">c</span><span class="dl">'</span><span class="p">]))</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// select and rename the first three columns, all other columns are dropped</span>
<span class="nx">table</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">aq</span><span class="p">.</span><span class="nx">names</span><span class="p">([</span><span class="dl">'</span><span class="s1">a</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">b</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">c</span><span class="dl">'</span><span class="p">]))</span>
</code></pre></div></div>


      
      <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
        This site is open source. <a href="https://github.com/uwdata/arquero/edit/main/docs/api/index.md">Improve this page</a>.
      </div>
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
