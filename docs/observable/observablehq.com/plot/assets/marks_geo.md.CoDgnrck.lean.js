import{A as y,B as q,b as _,c as P,C as k,D as u,E as A,z as j,r as S,e as w,bs as O,bt as I}from"./chunks/theme.C_36pXDy.js";import{f as d}from"./chunks/feature.DXDMwmIR.js";import{m as V}from"./chunks/mesh.DUGB6pHu.js";import{D as g,h as o,v as D,C as f,c as N,o as x,j as i,G as h,ah as e,a,t as v}from"./chunks/framework.DM5DyJ2q.js";const G={id:"geo-mark",tabindex:"-1"},R={class:"language-js vp-adaptive-theme"},J={class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},$={class:"line"},z={style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},H={class:"language-js vp-adaptive-theme"},M={class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},U={class:"line"},W={style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},Y={id:"sphere",tabindex:"-1"},L={id:"graticule",tabindex:"-1"},as=JSON.parse('{"title":"Geo mark","description":"","frontmatter":{},"headers":[],"relativePath":"marks/geo.md","filePath":"marks/geo.md"}'),K={name:"marks/geo.md"},ts=Object.assign(K,{setup(Q){const t=g(null),F=g([]),m=g({type:"FeatureCollection",features:[]}),E=g(null),B=o(()=>t.value?V(t.value,t.value.objects.states,(n,s)=>n!==s):{type:null}),C=o(()=>t.value?d(t.value,t.value.objects.nation):{type:null}),b=o(()=>t.value?d(t.value,t.value.objects.states):{type:null}),T=o(()=>t.value?d(t.value,t.value.objects.counties):{type:null}),c=o(()=>E.value?d(E.value,E.value.objects.land):{type:null});return D(()=>{y("https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.geojson").then(n=>F.value=n),y("../data/countries-110m.json").then(n=>E.value=n),q("../data/walmarts.tsv",_).then(n=>m.value={type:"FeatureCollection",features:n.map(s=>({type:"Feature",properties:{date:s.date},geometry:{type:"Point",coordinates:[s.longitude,s.latitude]}}))}),Promise.all([y("../data/us-counties-10m.json"),P("../data/us-county-unemployment.csv")]).then(([n,s])=>{const r=new Map(s.map(l=>[l.id,+l.rate]));n.objects.counties.geometries.forEach(l=>l.properties.unemployment=r.get(l.id)),t.value=n})}),(n,s)=>{const r=f("VersionBadge"),l=f("PlotRender");return x(),N("div",null,[i("h1",G,[s[0]||(s[0]=a("Geo mark ")),h(r,{version:"0.6.1"}),s[1]||(s[1]=a()),s[2]||(s[2]=i("a",{class:"header-anchor",href:"#geo-mark","aria-label":'Permalink to "Geo mark <VersionBadge version="0.6.1" />"'},"​",-1))]),s[55]||(s[55]=i("p",null,[a("The "),i("strong",null,"geo mark"),a(" draws geographic features — polygons, lines, points, and other geometry — often as thematic maps. It works with Plot’s "),i("a",{href:"./../features/projections"},"projection system"),a(". For example, the "),i("a",{href:"https://en.wikipedia.org/wiki/Choropleth_map",target:"_blank",rel:"noreferrer"},"choropleth map"),a(" below shows unemployment by county in the United States.")],-1)),h(l,{defer:"",options:{projection:"albers-usa",color:{type:"quantile",n:9,scheme:"blues",label:"Unemployment (%)",legend:!0},marks:[k(T.value,{fill:"unemployment",title:p=>`${p.properties.name} ${p.properties.unemployment}%`,tip:!0})]}},null,8,["options"]),s[56]||(s[56]=e("",2)),i("p",null,[s[3]||(s[3]=a("A geo mark’s data is typically ")),s[4]||(s[4]=i("a",{href:"https://geojson.org/",target:"_blank",rel:"noreferrer"},"GeoJSON",-1)),s[5]||(s[5]=a(". You can pass a single GeoJSON object, a feature or geometry collection, or an array or iterable of GeoJSON objects; Plot automatically normalizes these into an array of features or geometries. When a mark’s data is GeoJSON, Plot will look for the specified field name (such as ")),s[6]||(s[6]=i("em",null,"unemployment",-1)),s[7]||(s[7]=a(" above, for ")),s[8]||(s[8]=i("strong",null,"fill",-1)),s[9]||(s[9]=a(") in the GeoJSON object’s ")),s[10]||(s[10]=i("code",null,"properties",-1)),s[11]||(s[11]=a(" if the object does not have this property directly. ")),h(r,{version:"0.6.16",pr:"2092"})]),s[57]||(s[57]=e("",1)),h(l,{defer:"",options:{projection:"equirectangular",r:{transform:p=>Math.pow(10,p)},marks:[k(c.value,{fill:"currentColor",fillOpacity:.2}),u(),k(F.value,{r:"mag",fill:"var(--vp-c-red)",fillOpacity:.2,stroke:"var(--vp-c-red)",title:"title",href:"url",target:"_blank"})]}},null,8,["options"]),s[58]||(s[58]=e("",4)),h(l,{options:{inset:2,projection:{type:"orthographic",rotate:[0,-30,20]},marks:[u({fill:"var(--vp-c-bg-alt)",stroke:"currentColor"}),A({strokeOpacity:.3})]}},null,8,["options"]),s[59]||(s[59]=i("a",{class:"plot-fork no-icon",href:"https://observablehq.com/@observablehq/plot-sphere-and-graticule",target:"_blank",title:"Open on Observable"},"Fork",-1)),i("div",R,[s[20]||(s[20]=i("button",{title:"Copy Code",class:"copy"},null,-1)),s[21]||(s[21]=i("span",{class:"lang"},"js",-1)),i("pre",J,[i("code",null,[s[18]||(s[18]=e("",8)),i("span",$,[s[12]||(s[12]=i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Plot.",-1)),s[13]||(s[13]=i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sphere",-1)),s[14]||(s[14]=i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({fill: ",-1)),i("span",z,'"'+v(n.$dark?"black":"white")+'"',1),s[15]||(s[15]=i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", stroke: ",-1)),s[16]||(s[16]=i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"currentColor"',-1)),s[17]||(s[17]=i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}),",-1))]),s[19]||(s[19]=e("",6))])])]),s[60]||(s[60]=i("p",null,[a("The geo mark’s "),i("strong",null,"geometry"),a(" channel can be used to generate geometry from a non-GeoJSON data source. For example, below we visualize the shockwave created by the explosion of the "),i("a",{href:"https://en.wikipedia.org/wiki/2021%E2%80%9322_Hunga_Tonga%E2%80%93Hunga_Ha%CA%BBapai_eruption_and_tsunami",target:"_blank",rel:"noreferrer"},"Hunga Tonga–Hunga Haʻapai volcano"),a(" on January 15, 2022 with a series of geodesic circles of increasing radius.")],-1)),h(l,{defer:"",options:{projection:{type:"equal-earth",rotate:[90,0]},color:{legend:!0,label:"Distance from Tonga (km)",transform:p=>111.2*p,zero:!0},marks:[k(c.value),k([.5,179.5].concat(S(10,171,10)),{geometry:j().center([-175.38,-20.57]).radius(p=>p),stroke:p=>p,strokeWidth:2}),u()]}},null,8,["options"]),s[61]||(s[61]=e("",2)),i("p",null,[s[22]||(s[22]=e("",13)),h(r,{version:"0.6.16",pr:"2088"}),s[23]||(s[23]=a(" You can alternatively specify these channels explicitly. The centroids are shown below in red."))]),h(l,{defer:"",options:{projection:"albers-usa",marks:[k(b.value,{strokeOpacity:.1,tip:!0,title:"name"}),k(C.value),w(b.value,O({fill:"var(--vp-c-red)",stroke:"var(--vp-c-bg-alt)"}))]}},null,8,["options"]),s[62]||(s[62]=i("a",{class:"plot-fork no-icon",href:"https://observablehq.com/@observablehq/plot-state-centroids",target:"_blank",title:"Open on Observable"},"Fork",-1)),i("div",H,[s[31]||(s[31]=i("button",{title:"Copy Code",class:"copy"},null,-1)),s[32]||(s[32]=i("span",{class:"lang"},"js",-1)),i("pre",M,[i("code",null,[s[26]||(s[26]=e("",10)),i("span",U,[s[24]||(s[24]=e("",7)),i("span",W,'"'+v(n.$dark?"black":"white")+'"',1),s[25]||(s[25]=i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}))",-1))]),s[27]||(s[27]=a(`
`)),s[28]||(s[28]=i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  ]")],-1)),s[29]||(s[29]=a(`
`)),s[30]||(s[30]=i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"})")],-1))])])]),s[63]||(s[63]=i("p",null,[a("The geo mark supports "),i("a",{href:"./../features/facets"},"faceting"),a(". Below, a comic strip of sorts shows the locations of Walmart store openings in past decades.")],-1)),h(l,{defer:"",options:{margin:0,padding:0,projection:"albers",fy:{interval:"10 years"},marks:[k(B.value,{strokeOpacity:.2}),k(C.value),k(m.value,{fy:"date",r:1.5,fill:"var(--vp-c-blue)",tip:!0,title:"date"}),I({frameAnchor:"top",dy:30,tickFormat:p=>`${p.getUTCFullYear()}’s`})]}},null,8,["options"]),s[64]||(s[64]=e("",7)),i("p",null,[s[33]||(s[33]=a("The ")),s[34]||(s[34]=i("strong",null,"x",-1)),s[35]||(s[35]=a(" and ")),s[36]||(s[36]=i("strong",null,"y",-1)),s[37]||(s[37]=a(" position channels may also be specified in conjunction with the ")),s[38]||(s[38]=i("strong",null,"tip",-1)),s[39]||(s[39]=a(" option. ")),h(r,{version:"0.6.16",pr:"2088"}),s[40]||(s[40]=a(" These are bound to the ")),s[41]||(s[41]=i("em",null,"x",-1)),s[42]||(s[42]=a(" and ")),s[43]||(s[43]=i("em",null,"y",-1)),s[44]||(s[44]=a(" scale (or projection), respectively."))]),s[65]||(s[65]=e("",3)),i("h2",Y,[s[45]||(s[45]=a("sphere(")),s[46]||(s[46]=i("em",null,"options",-1)),s[47]||(s[47]=a(") ")),h(r,{version:"0.6.1"}),s[48]||(s[48]=a()),s[49]||(s[49]=i("a",{class:"header-anchor",href:"#sphere","aria-label":'Permalink to "sphere(*options*) <VersionBadge version="0.6.1" /> {#sphere}"'},"​",-1))]),s[66]||(s[66]=e("",2)),i("h2",L,[s[50]||(s[50]=a("graticule(")),s[51]||(s[51]=i("em",null,"options",-1)),s[52]||(s[52]=a(") ")),h(r,{version:"0.6.1"}),s[53]||(s[53]=a()),s[54]||(s[54]=i("a",{class:"header-anchor",href:"#graticule","aria-label":'Permalink to "graticule(*options*) <VersionBadge version="0.6.1" /> {#graticule}"'},"​",-1))]),s[67]||(s[67]=e("",2))])}}});export{as as __pageData,ts as default};
