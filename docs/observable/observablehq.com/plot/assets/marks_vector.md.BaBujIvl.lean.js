import{l as K,c as D,b as Z,A as $,aF as S,C as _,bs as ss,bN as is,br as ts}from"./chunks/theme.C_36pXDy.js";import{f as as}from"./chunks/feature.DXDMwmIR.js";import{m as W}from"./chunks/mesh.DUGB6pHu.js";import{D as L,h as V,v as ns,C as G,c as M,o as I,j as r,ah as v,G as b,a as k,k as R}from"./chunks/framework.DM5DyJ2q.js";function*es([i,e,o,n],y,E=30,l=K(42)){const h=o-i,s=n-e,p=h*s/(y*1.5),d=Math.sqrt(p),a=3*p,t=d*Math.SQRT1_2,m=Math.ceil(h/t),O=Math.ceil(s/t),U=new Array(m*O),F=[];yield Y(h/2+l()*d,s/2+l()*d);s:for(;F.length;){const g=l()*F.length|0,c=F[g];for(let B=0;B<E;++B){const A=2*Math.PI*l(),x=Math.sqrt(l()*a+p),f=c[0]+x*Math.cos(A),C=c[1]+x*Math.sin(A);if(0<=f&&f<h&&0<=C&&C<s&&J(f,C)){yield Y(f,C);continue s}}const w=F.pop();g<F.length&&(F[g]=w)}function J(g,c){const w=g/t|0,B=c/t|0,A=Math.max(w-2,0),x=Math.max(B-2,0),f=Math.min(w+3,m),C=Math.min(B+3,O);for(let T=x;T<C;++T){const Q=T*m;for(let P=A;P<f;++P){const j=U[Q+P];if(j){const X=j[0]-g,z=j[1]-c;if(X*X+z*z<p)return!1}}}return!0}function Y(g,c){return F.push(U[m*(c/t|0)+(g/t|0)]=[g,c]),[g+i,c+e]}}function hs(i,e){const o=Math.floor(i),n=Math.floor(e),y=o&255,E=n&255,l=H(i-=o),h=H(e-=n),s=u[y]+E,p=u[y+1]+E;return N(h,N(l,q(u[s],i,e),q(u[p],i-1,e)),N(l,q(u[s+1],i,e-1),q(u[p+1],i-1,e-1)))}function ls(i,e){return function(o,n,y){let E=0,l=1,h=1,s=0;for(let p=0;p<e;++p)s+=i(o*l,n*l,y*l)*h,E+=h,h*=.5,l*=2;return s/E}}function q(i,e,o){const n=i&1?o:e;return i&2?-n:n}function H(i){return i*i*i*(i*(i*6-15)+10)}function N(i,e,o){return e+i*(o-e)}const ps=Uint8Array.of(151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180),u=new Uint8Array(512);for(let i=0;i<256;++i)u[i]=u[i+256]=ps[i];const os={id:"vector-mark",tabindex:"-1"},rs={width:"12",height:"12",viewBox:"-11 -11 12 12",style:{display:"inline-block"}},ks={width:"12",height:"12",viewBox:"0 -11 12 12",style:{display:"inline-block"}},Es={id:"spike",tabindex:"-1"},us=JSON.parse('{"title":"Vector mark","description":"","frontmatter":{},"headers":[],"relativePath":"marks/vector.md","filePath":"marks/vector.md"}'),ds={name:"marks/vector.md"},Fs=Object.assign(ds,{setup(i){const e=ls(hs,2),o=L([{longitude:-9.875,latitude:45.125},{longitude:9.875,latitude:59.875},{u:0,v:0},{u:0,v:12.184501776503668}]),n=L(null),y=V(()=>n.value?W(n.value,n.value.objects.nation):{type:null}),E=V(()=>n.value?W(n.value,n.value.objects.states,(h,s)=>h!==s):{type:null}),l=V(()=>n.value?as(n.value,n.value.objects.counties).features:[]);return ns(()=>{D("../data/wind.csv",Z).then(h=>o.value=h),Promise.all([$("../data/us-counties-10m.json"),D("../data/us-county-population.csv"),D("../data/us-presidential-election-2020.csv")]).then(([h,s,p])=>{const d=new Map(s.map(t=>[t.state+t.county,+t.population])),a=new Map(p.map(t=>[t.fips,t]));for(const t of h.objects.counties.geometries){t.properties.population=d.get(t.id);const m=a.get(t.id);m&&(t.properties.margin2020=+m.margin2020,t.properties.votes=+m.votes)}n.value=h})}),(h,s)=>{const p=G("VersionBadge"),d=G("PlotRender");return I(),M("div",null,[r("h1",os,[s[0]||(s[0]=k("Vector mark ")),b(p,{version:"0.4.0"}),s[1]||(s[1]=k()),s[2]||(s[2]=r("a",{class:"header-anchor",href:"#vector-mark","aria-label":'Permalink to "Vector mark <VersionBadge version="0.4.0" />"'},"​",-1))]),s[21]||(s[21]=v("",2)),b(d,{defer:"",options:{inset:10,aspectRatio:1,color:{label:"Speed (m/s)",zero:!0,legend:!0},marks:[S(o.value,{x:"longitude",y:"latitude",rotate:({u:a,v:t})=>Math.atan2(a,t)*180/Math.PI,length:({u:a,v:t})=>Math.hypot(a,t),stroke:({u:a,v:t})=>Math.hypot(a,t)})]}},null,8,["options"]),s[22]||(s[22]=v("",3)),r("p",null,[s[5]||(s[5]=k("Vectors can be used with Plot’s ")),s[6]||(s[6]=r("a",{href:"./../features/projections"},"projection system",-1)),s[7]||(s[7]=k(". The map below shows the margin by which the winner of the US presidential election of 2020 won the vote in each county. The arrow’s length encodes the difference in votes, and the orientation and color show who won (")),(I(),M("svg",rs,s[3]||(s[3]=[r("path",{d:"M0,0l-10,-6m1,3.28l-1,-3.28l3.28,-1",stroke:"var(--vp-c-blue)","stroke-width":"1.5"},null,-1)]))),s[8]||(s[8]=k(" for the Democratic candidate, and ")),(I(),M("svg",ks,s[4]||(s[4]=[r("path",{d:"M0,0l10,-6m-1,3.28l1,-3.28l-3.28,-1",stroke:"var(--vp-c-red)","stroke-width":"1.5"},null,-1)]))),s[9]||(s[9]=k(" for the Republican candidate)."))]),b(d,{defer:"",options:{projection:"albers-usa",length:{type:"sqrt",transform:Math.abs},marks:[_(E.value,{strokeWidth:.5}),_(y.value),S(l.value,ss({anchor:"start",length:a=>a.properties.margin2020*a.properties.votes,stroke:a=>a.properties.margin2020>0?"var(--vp-c-red)":"var(--vp-c-blue)",rotate:a=>a.properties.margin2020>0?60:-60}))]}},null,8,["options"]),s[23]||(s[23]=v("",2)),r("p",null,[s[10]||(s[10]=k("The ")),s[11]||(s[11]=r("strong",null,"shape",-1)),s[12]||(s[12]=k(" option ")),b(p,{version:"0.6.2"}),s[13]||(s[13]=v("",19))]),b(d,{defer:"",options:{width:688,projection:"albers-usa",length:{range:[0,200]},marks:[_(E.value,{strokeOpacity:.5}),_(y.value),is(l.value,ts({length:a=>a.properties.population,stroke:"var(--vp-c-green)"}))]}},null,8,["options"]),s[24]||(s[24]=v("",4)),b(d,{defer:"",options:{inset:6,width:1024,aspectRatio:1,axis:null,marks:[S(R(es)([0,0,2,2],4e3),{length:([a,t])=>(R(e)(a+2,t)+.5)*24,rotate:([a,t])=>R(e)(a,t)*360})]}},null,8,["options"]),s[25]||(s[25]=v("",27)),r("h2",Es,[s[14]||(s[14]=k("spike(")),s[15]||(s[15]=r("em",null,"data",-1)),s[16]||(s[16]=k(", ")),s[17]||(s[17]=r("em",null,"options",-1)),s[18]||(s[18]=k(") ")),b(p,{version:"0.6.2"}),s[19]||(s[19]=k()),s[20]||(s[20]=r("a",{class:"header-anchor",href:"#spike","aria-label":'Permalink to "spike(*data*, *options*) <VersionBadge version="0.6.2" /> {#spike}"'},"​",-1))]),s[26]||(s[26]=v("",2))])}}});export{us as __pageData,Fs as default};
