<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test 4: SQL.js Alternative</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #fff; }
        .status { padding: 10px; margin: 10px 0; background: #333; }
        .success { background: #2d5a2d; }
        .error { background: #5a2d2d; }
    </style>
</head>
<body>
    <h1>Test 4: SQL.js - A Working Offline Alternative</h1>
    <div id="status" class="status">Loading SQL.js...</div>
    <pre id="output"></pre>
    
    <!-- SQL.js can be inlined because it's simpler -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
    <script>
        const status = document.getElementById('status');
        const output = document.getElementById('output');
        
        async function testSQLjs() {
            try {
                // Initialize SQL.js
                const sqlPromise = initSqlJs({
                    locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}`
                });
                
                const SQL = await sqlPromise;
                const db = new SQL.Database();
                
                status.textContent = 'SQL.js loaded successfully!';
                status.className = 'status success';
                
                // Create table and insert data
                db.run(`
                    CREATE TABLE users (id INT, name TEXT, age INT);
                    INSERT INTO users VALUES 
                        (1, 'Alice', 30),
                        (2, 'Bob', 25),
                        (3, 'Charlie', 35);
                `);
                
                // Query data
                const stmt = db.prepare("SELECT * FROM users WHERE age > ?");
                const result = stmt.getAsObject({':1': 26});
                
                output.textContent = `
SQL.js works offline because:
1. Single WASM file (~2.5MB vs DuckDB's 10MB)
2. No Web Workers required
3. No SharedArrayBuffer needed
4. Simpler architecture

Query result: ${JSON.stringify(result, null, 2)}

Limitations vs DuckDB:
- No parallel processing
- Smaller feature set
- No Arrow integration
- Less performant on large datasets
                `;
                
            } catch (error) {
                status.textContent = 'Error: ' + error.message;
                status.className = 'status error';
                output.textContent = error.stack;
            }
        }
        
        testSQLjs();
    </script>
</body>
</html>